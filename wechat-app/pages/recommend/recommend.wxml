<view class="container">
  <!-- 日期标题 -->
  <view class="date-header">
    <text class="date-today">TODAY</text>
    <text class="date-full">{{today}}</text>
  </view>

  <!-- 页面标题 -->
  <view class="recommend-header">
    <text class="page-title">今日推荐</text>
    <text class="page-desc">为你精选的美味食谱</text>
  </view>

  <!-- 推荐列表 -->
  <view class="recommend-list" wx:if="{{recipes.length > 0}}">
    <view class="recommend-card {{index === 0 ? 'featured' : ''}}" 
          wx:for="{{recipes}}" 
          wx:key="_id"
          bindtap="goToDetail"
          data-id="{{item._id}}">
      
      <!-- 推荐标签 -->
      <view class="recommend-tag" wx:if="{{index === 0}}">
        <image src="/images/star.png" mode="aspectFit"/>
        <text>今日首选</text>
      </view>
      <view class="recommend-tag secondary" wx:else>
        <text>推荐搭配</text>
      </view>

      <!-- 菜谱图片 -->
      <view class="card-image-wrapper">
        <image class="card-image {{!item.imageUrl ? 'placeholder' : ''}}" 
               src="{{item.imageUrl || '/images/default-food.png'}}" 
               mode="aspectFill"/>
        <view class="cuisine-tag">{{item.cuisine}}</view>
      </view>

      <!-- 菜谱信息 -->
      <view class="card-content">
        <text class="card-title">{{item.name}}</text>
        
        <!-- 食材预览 -->
        <view class="ingredients-preview">
          <text class="preview-label">主要食材：</text>
          <text class="preview-list">
            <text wx:for="{{item.ingredients}}" wx:key="name" wx:for-index="idx" wx:for-item="ing">
              <text wx:if="{{idx < 4}}">{{ing.name}}<text wx:if="{{idx < 3 && idx < item.ingredients.length - 1}}">、</text></text>
            </text>
            <text wx:if="{{item.ingredients.length > 4}}">...</text>
          </text>
        </view>

        <!-- 元信息 -->
        <view class="card-meta">
          <view class="meta-item">
            <image src="/images/time.png" mode="aspectFit"/>
            <text>{{item.cookTime || '30'}}分钟</text>
          </view>
          <view class="meta-item">
            <image src="/images/difficulty.png" mode="aspectFit"/>
            <text>{{difficultyText[item.difficulty - 1] || '简单'}}</text>
          </view>
          <view class="meta-item">
            <image src="/images/fire.png" mode="aspectFit"/>
            <text>{{item.favoriteCount}}人收藏</text>
          </view>
        </view>

        <!-- 收藏按钮 -->
        <view class="card-actions">
          <view class="action-btn favorite {{item.isFavorite ? 'active' : ''}}" 
                catchtap="toggleFavorite" 
                data-id="{{item._id}}"
                data-index="{{index}}">
            <image src="{{item.isFavorite ? '/images/heart-filled.png' : '/images/heart.png'}}" mode="aspectFit"/>
            <text>{{item.isFavorite ? '已收藏' : '收藏'}}</text>
          </view>
          <view class="action-btn view" bindtap="goToDetail" data-id="{{item._id}}">
            <text>查看做法</text>
            <image src="/images/arrow-right.png" mode="aspectFit"/>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{!loading && recipes.length === 0}}">
    <image src="/images/empty-recommend.png" mode="aspectFit" class="empty-icon"/>
    <text class="empty-text">今日推荐准备中\n明天再来看看吧</text>
  </view>

  <!-- 重新推荐按钮 -->
  <view class="refresh-section" wx:if="{{recipes.length > 0}}">
    <view class="btn btn-outline" bindtap="refreshRecommend">
      <image src="/images/refresh.png" mode="aspectFit"/>
      <text>换一批推荐</text>
    </view>
  </view>
</view>
